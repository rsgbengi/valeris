id: no_new_privileges
name: "no-new-privileges Not Set"
target: docker_runtime
severity: MEDIUM
description: Detects containers without no-new-privileges flag to prevent privilege escalation.
match:
  jsonpath: "$.HostConfig.SecurityOpt[*]"
  regex: "no-new-privileges"
  missing: true
message: "Container allows privilege escalation (no-new-privileges not set)"
fix: |
  Add --security-opt no-new-privileges:true to prevent setuid binaries from escalating privileges.
